name: Build dotnet application

on:
  workflow_call:
    inputs:
      resource_group:
        description: RG to deploy to
        type: string
      
      aci_name:
        description: Name of ACI to deploy to
        type: string
      
      image:
        description: Image to deploy
        type: string

    secrets:
      azure_creds:
        description: Azure credentials to log into subscription
        type: string

jobs:
  deploy:
    name: Deploy image to ACI

    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v2
      
      - name: Azure login
        uses: azure/login@v1
        with:
          creds: ${{ secrets.azure_creds }}
      
      - name: Deploy the image
        run: |
          infra/aci.sh ${{ inputs.resource_group }} ${{ inputs.aci_name }} ${{ inputs.image }}
